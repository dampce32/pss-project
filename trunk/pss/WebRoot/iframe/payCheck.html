<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>供应商对账</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<link rel="stylesheet" type="text/css" href="../style/v1/easyui/easyui.css">
		<link rel="stylesheet" type="text/css" href="../style/v1/icon.css">
		
		<script type="text/javascript" src="../jjs/common/jquery-1.7.2.min.js"></script>
		<script type="text/javascript" src="../jjs/common/jquery.easyui.min.js"></script>
		<script type="text/javascript" src="../jjs/common/easyui-lang-zh_CN.js"></script>
		<script type="text/javascript" src="../js/My97DatePicker/WdatePicker.js"></script>
		<script src="../js/gridpp/CreateControl.js" type="text/javascript"></script>
		<script type="text/javascript">
//在网页初始加载时启动报表的运行显示
function window_onload() 
{
	btnRefresh_onclick();
}

//打印预览报表
function btnPreview_onclick() 
{
    ReportViewer.Report.PrintPreview(true);
}

//根据数据过滤参数重新显示报表
function btnRefresh_onclick() 
{
    ReportViewer.Stop();
    
    var BeginDate = document.getElementById("txtBeginDate").value;
    var EndDate = document.getElementById("txtEndDate").value;
    var DataURL = encodeURI("xmlSummary.jsp?BeginDate=" + BeginDate + "&EndDate=" + EndDate);
    ReportViewer.DataURL = DataURL;
    
    //更新查询参数更新报表付标题，设置对应静态框的“Text”属性
    ReportViewer.Report.ControlByName("SubTitle").AsStaticBox.Text = "日期范围：" + BeginDate + "至" + EndDate;
    
    ReportViewer.Start();
}

//打开当前行对应的明细报表
function btnDrillDown_onclick() 
{
    var ProductID = ReportViewer.Report.FieldByName("ProductID").AsInteger;
    var BeginDate = document.getElementById("txtBeginDate").value;
    var EndDate = document.getElementById("txtEndDate").value;
    var URL = "Detail.jsp?ProductID=" + ProductID + "&BeginDate='" + BeginDate + "'&EndDate='" + EndDate + "'";
	window.open(URL, "_blank");
}

function OnContentCellDblClick(Sender) //响应内容行双击事件，打开当前行对应的明细报表 
{
	btnDrillDown_onclick();
}
	</script>
    <style type="text/css">
        html,body {
            margin:0;
            height:100%;
        }
    </style>
</head>
<body style="margin:0; background-color: #f0ffff;" >
	<table border="0" width="100%" height="125px">
		<tr style="width: 100%;">
			<td style="font-size: 10pt;height: 20px  ">
			日期:<input type="text"  id="txtBeginDate"  style="width: 100px" size="40" class="Wdate" onFocus="WdatePicker({dateFmt:'yyyy-MM-dd',maxDate:'#F{$dp.$D(\'txtEndDate\');}'});" />
			至:<input type="text"  id="txtEndDate"  style="width: 100px" size="40" class="Wdate" onFocus="WdatePicker({dateFmt:'yyyy-MM-dd',minDate:'#F{$dp.$D(\'txtBeginDate\');}'});" />
                <input id="btnRefresh" onclick="return btnRefresh_onclick()" type="button" value="更新显示"
					name="btnRefresh"/>
			</td>
		</tr>
	</table>
	<p>
		<script type="text/javascript"> 
            CreatePrintViewerEx("100%", "100%","../report/buy.grf", "../ReportServlet?buyId=402880bb3c8542f0013c854975af0001&reportCode=buy", true, "<param name=BorderStyle value=1>");
        </script>
	</p>
</body>
</html>
